<!DOCTYPE html>
<html>
<head>
<title>AWE basic AR demo</title>
<meta name="viewport"
	content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
<meta charset="utf-8" />
<style type="text/css">
* {
	margin: 0;
	padding: 0;
}

#container {
	position: absolute;
	left: 0;
	top: 0;
	bottom: 0;
	right: 0;
	overflow: hidden;
}
</style>
</head>
<body>
	<div id="container"></div>
	<script type="text/javascript" src="../../js/awe-v8.js"></script>
	<script type="text/javascript" src="../../js/awe-loader.js"></script>
	<script type="text/javascript">
		var r = 300;
		var x = r * Math.cos(-33.998663) * Math.cos(25.652881);
		var y = r * Math.cos(-33.998663) * Math.sin(25.652881);
		var z = r * Math.sin(-33.998663);
		window
				.addEventListener(
						'load',
						function() {
							// initialize awe after page loads
							window.awe
									.init({
										// automatically detect the device type
										device_type : awe.AUTO_DETECT_DEVICE_TYPE,
										// populate some default settings
										settings : {
											container_id : 'container',
											fps : 30,
											default_camera_position : {
												x : 0,
												y : 0,
												z : 0
											},
											default_lights : [ {
												id : 'hemisphere_light',
												type : 'hemisphere',
												color : 0xCCCCCC
											}, ],
										},
										ready : function() {
											var d = '?_=' + Date.now();

											// load js files based on capability detection then setup the scene if successful
											awe.util
													.require([
															{
																capabilities : [
																		'webgl',
																		'gum' ],
																files : [
																		[
																				'../../js/awe-standard-dependencies.js'
																						+ d,
																				'../../js/awe-standard.js'
																						+ d ], // core dependencies for this app 
																		[
																				'../../js/plugins/StereoEffect.js'
																						+ d,
																				'../../js/plugins/VREffect.js'
																						+ d ], // dependencies for render effects
																		'../../js/plugins/awe.rendering_effects.js'
																				+ d,
																		'../../js/plugins/awe-standard-object_clicked_or_focused.js'
																				+ d, // object click/tap handling plugin
																		'awe.gyro.js'
																				+ d, // basic gyro handling
																		'awe.mouse.js'
																				+ d, // basic mouse handling
																],
																success : function() {
																	// setup and paint the scene
																	awe
																			.setup_scene();

																	var click_plugin = awe.plugins
																			.view('object_clicked');
																	if (click_plugin) {
																		click_plugin
																				.register();
																		click_plugin
																				.enable();
																	}
																	var gyro_plugin = awe.plugins
																			.view('gyro');
																	if (gyro_plugin) {
																		gyro_plugin
																				.enable();
																	}
																	var mouse_plugin = awe.plugins
																			.view('gyro');
																	if (gyro_plugin) {
																		gyro_plugin
																				.enable();
																	}

																	awe.settings
																			.update({
																				data : {
																					value : 'ar'
																				},
																				where : {
																					id : 'view_mode'
																				}
																			})
																	var render_effects_plugin = awe.plugins
																			.view('render_effects');
																	if (render_effects_plugin) {
																		render_effects_plugin
																				.enable();
																	}
																	awe.pois
																			.add({
																				id : 'north',
																				position : {
																					x : r * Math.cos(-34.000736) * Math.cos(25.645650),
																					y : r * Math.cos(-34.000736) * Math.sin(25.645650),
																					z : r * Math.sin(-34.000736)
																				}
																			});
																	awe.pois
																	.add({
																		id : 'spar',
																		position : {
																			x : r * Math.cos(-33.998663) * Math.cos(25.652881),
																			y : r * Math.cos(-33.998663) * Math.sin(25.652881),
																			z : r * Math.sin(-33.998663)
																		}
																	});
																	var poi = awe.pois.view('spar');
																	poi
																			.update({
																				position : {
																					x : r * Math.cos(-33.998663) * Math.cos(25.652881),
																					y : r * Math.cos(-33.998663) * Math.sin(25.652881),
																					z : r * Math.sin(-33.998663)
																				//translate z to -z
																				}
																			});
																	poi = awe.pois.view('north');
																	poi
																			.update({
																				position : {
																					x : r * Math.cos(-34.000736) * Math.cos(25.645650),
																					y : r * Math.cos(-34.000736) * Math.sin(25.645650),
																					z : r * Math.sin(-34.000736)
																				//translate z to -z
																				}
																			});
																	
																	// 			        if (device.platform == 'iOS') {
																	// 			            //rotate 90
																	// 			            var vec = new THREE.Vector2(poi.position.x,poi.position.z);
																	// 			            var rot = THREE.Math.degToRad(90); 
																	// 			            vec.rotateAround({x:0,y:0}, rot);
																	// 			            poi.update({position: {x:vec.x,z:vec.y}});

																	// 			        }
																	// add projections to each of the pois
																	awe.projections
																			.add(
																					{
																						id : 'n',
																						geometry : {
																							shape : 'cube',
																							x : 50,
																							y : 50,
																							z : 50
																						},
																						rotation : {
																							x : 30,
																							y : 30,
																							z : 0
																						},
																						material : {
																							type : 'phong',
																							color : 0xFF0000,
																						},
																					},
																					{
																						poi_id : 'north'
																					});

																	awe.projections
																	.add(
																			{
																				id : 's',
																				geometry : {
																					shape : 'cube',
																					x : 50,
																					y : 50,
																					z : 50
																				},
																				rotation : {
																					x : 30,
																					y : 60,
																					z : 0
																				},
																				material : {
																					type : 'phong',
																					color : 0x00FF00,
																				},
																			},
																			{
																				poi_id : 'spar'
																			});

																	
																	awe.projections
																			.update({
																				data : {
																					animation : {
																						duration : 5,
																						persist : 0,
																						repeat : Infinity
																					},
																					rotation : {
																						y : 360
																					},
																				},
																				where : {
																					id : "north"
																				},
																			});

																},
															},
															{ // else create a fallback
																capabilities : [],
																files : [],
																success : function() {
																	document.body.innerHTML = '<p>This demo currently requires a standards compliant mobile browser.';
																	return;
																},
															}, ]);
										}
									});
						});
	</script>
</body>
</html>
